import{r as b,w as V,d as F,c as j,u as N,s as C,x as R,j as e,R as B,a as A,v as T,B as q,S as D}from"./index-CyotTLIc.js";import{z as m,u as I,s as L,I as g}from"./zod-U6cRdzX7.js";const M=m.object({firstName:m.string().min(1,{message:"First name is required"}),lastName:m.string().min(1,{message:"Last name is required"}),email:m.string().min(1,{message:"Email address is required"}).email(),password:m.string().min(8,{message:"Password must be at least 8 chars"}).regex(/.*[!@#$%^&*()_+{}|[\]\\:";'<>?,./].*/,{message:"Password must have special chars"}),confirmPassword:m.string().min(1,{message:"Password must confirmed"})}).refine(s=>s.confirmPassword===s.password,{message:"Password and Confirm Password didn't match",path:["confirmPassword"]}),U=()=>{const[s,i]=b.useState("idle"),[a,t]=b.useState(null);return{emailValidityStatus:s,prevEmail:a,checkEmailValidity:async l=>{i("checking"),t(l);try{(await V.get(`/users?email=${l}`)).data.length?i("notValid"):i("valid")}catch{i("failed")}},resetCheckEmailValidity:()=>{i("idle"),t(null)}}},z=()=>{const s=F(),{error:i,loading:a}=j(n=>n.authSlice),t=N(),{register:o,handleSubmit:c,formState:{errors:l},getFieldState:r,trigger:E,setFocus:d}=I({resolver:L(M),mode:"onBlur"}),h=async n=>{d("email");const{firstName:y,lastName:x,email:S,password:P}=n;s(R({firstName:y,lastName:x,email:S,password:P})).unwrap().then(()=>t("/login?message=account_created"))},{emailValidityStatus:p,prevEmail:u,checkEmailValidity:f,resetCheckEmailValidity:w}=U(),v=async n=>{await E("email");const{isDirty:y,invalid:x}=r("email"),S=n.target.value;y&&!x&&u!==S&&f(S),y&&x&&u&&w()},k=j(n=>n.authSlice.accessToken);return b.useEffect(()=>(k&&t("/"),()=>{s(C())}),[s]),{register:o,handleSubmit:c,formState:{errors:l},setFocus:d,error:i,loading:a,emailOnBlurHandler:v,emailValidityStatus:p,submitForm:h}},_=()=>{var d,h,p,u,f,w;const{register:s,handleSubmit:i,formState:{errors:a},setFocus:t,error:o,loading:c,emailOnBlurHandler:l,emailValidityStatus:r,submitForm:E}=z();return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"User Registeration"}),e.jsx(B,{children:e.jsx(A,{md:{span:6,offset:3},children:e.jsxs(T,{onSubmit:i(E),children:[e.jsx(g,{label:"First Name",name:"firstName",error:(d=a.firstName)==null?void 0:d.message,register:s}),e.jsx(g,{label:"Last Name",name:"lastName",error:(h=a.lastName)==null?void 0:h.message,register:s}),e.jsx(g,{label:"Email Address",name:"email",error:(p=a.email)!=null&&p.message?(u=a.email)==null?void 0:u.message:r==="notValid"?"This email is already in use.":r==="failed"?"Error from the server.":"",register:s,onBlur:l,checkMessage:r==="checking"?"We're currently checking the availability of this email address. Please wait a moment.":"",successMessage:r==="valid"?"Email is valid":""}),e.jsx(g,{label:"Password",name:"password",error:(f=a.password)==null?void 0:f.message,register:s,type:"password"}),e.jsx(g,{label:"Confirm Password",name:"confirmPassword",error:(w=a.confirmPassword)==null?void 0:w.message,register:s,type:"password"}),e.jsx(q,{variant:"primary",type:"submit",disabled:r==="checking"||r==="notValid"?!0:c==="pending",onMouseEnter:()=>t("email"),children:c==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(D,{animation:"border",size:"sm"})," Loading..."]}):"Submit"}),o&&e.jsx("p",{style:{color:"#DC3545",marginTop:"10px"},children:o})]})})})]})};export{_ as default};
